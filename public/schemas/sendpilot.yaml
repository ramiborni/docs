openapi: 3.0.0
info:
  title: SendPilot Integration API
  description: SendPilot LinkedIn API integration with sandbox and production modes
  version: "1.0"
  contact: {}
servers:
  - url: https://integration-api-gateway.agreeablesea-e4815929.swedencentral.azurecontainerapps.io/api/account
    description: Production and Sandbox server
tags:
  - name: Messaging
    description: LinkedIn messaging and connection requests
  - name: Accounts
    description: Account management and authentication
  - name: Webhooks
    description: Webhook configuration and management
paths:
  /messaging/connection-request:
    post:
      summary: Send a LinkedIn connection request
      description: Send a connection request to a LinkedIn profile with an optional custom note
      operationId: MessagingController_sendConnectionRequest
      tags:
        - Messaging
      security:
        - apiKey: []
      requestBody:
        required: true
        description: Connection request details
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ConnectionRequestDto'
      responses:
        '200':
          description: Connection request sent successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConnectionRequestResponseDto'
        '400':
          description: Invalid request data
        '401':
          description: Invalid or missing API key
  /messaging/message:
    post:
      summary: Send a LinkedIn message
      description: Send a message to a LinkedIn connection with optional text, attachments, voice, or video
      operationId: MessagingController_sendMessage
      tags:
        - Messaging
      security:
        - apiKey: []
      requestBody:
        required: true
        description: Message details and content
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SendMessageDto'
      responses:
        '201':
          description: Message sent successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SendMessageResponseDto'
        '400':
          description: Invalid request data
        '401':
          description: Invalid or missing API key
  /messaging/messages:
    get:
      summary: Retrieve LinkedIn messages
      description: Get a list of messages for a specific LinkedIn account
      operationId: MessagingController_getMessages
      tags:
        - Messaging
      security:
        - apiKey: []
      parameters:
        - name: linkedinAccountId
          required: true
          in: query
          description: LinkedIn account ID to retrieve messages for
          schema:
            type: string
            example: clxxx123456
        - name: limit
          required: true
          in: query
          description: Maximum number of messages to retrieve
          schema:
            type: number
            minimum: 1
            example: 50
      responses:
        '200':
          description: Messages retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GetMessagesResponseDto'
        '400':
          description: Invalid query parameters
        '401':
          description: Invalid or missing API key
  /accounts/status:
    get:
      summary: Get account status
      description: Retrieve current status and usage limits for a LinkedIn account
      operationId: AccountsController_getAccountStatus
      tags:
        - Accounts
      security:
        - apiKey: []
      parameters:
        - name: linkedinAccountId
          required: true
          in: query
          description: LinkedIn Account ID to check status for
          schema:
            type: string
            example: acc_123456
      responses:
        '200':
          description: Account status retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GetAccountStatusResponseDto'
        '400':
          description: Invalid query parameters
        '401':
          description: Invalid or missing API key
  /accounts/logout:
    post:
      summary: Logout LinkedIn account
      description: Logout and disconnect a LinkedIn account from SendPilot
      operationId: AccountsController_logoutAccount
      tags:
        - Accounts
      security:
        - apiKey: []
      requestBody:
        required: true
        description: Account logout details
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AccountLogoutDto'
      responses:
        '200':
          description: Account logged out successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AccountLogoutResponseDto'
        '400':
          description: Invalid request data
        '401':
          description: Invalid or missing API key
  /accounts/connect-linkedin:
    post:
      summary: Connect LinkedIn account
      description: Connect a LinkedIn account to SendPilot using credentials or tokens
      operationId: AccountsController_connectLinkedIn
      tags:
        - Accounts
      security:
        - apiKey: []
      requestBody:
        required: true
        description: LinkedIn connection details
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ConnectLinkedInDto'
      responses:
        '200':
          description: LinkedIn account connected successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConnectLinkedInResponseDto'
        '400':
          description: Invalid request data
        '401':
          description: Invalid or missing API key
  /accounts/reconnect-linkedin:
    post:
      summary: Reconnect LinkedIn account
      description: Reconnect an existing LinkedIn account to SendPilot with updated credentials or tokens
      operationId: AccountsController_reconnectLinkedIn
      tags:
        - Accounts
      security:
        - apiKey: []
      requestBody:
        required: true
        description: LinkedIn reconnection details including account ID
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ReconnectLinkedInDto'
      responses:
        '200':
          description: LinkedIn account reconnected successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ReconnectLinkedInResponseDto'
        '400':
          description: Invalid request data
        '401':
          description: Invalid or missing API key
        '404':
          description: LinkedIn account not found
  /webhooks/register:
    post:
      summary: Register a webhook URL
      description: Register a webhook URL to receive event notifications from SendPilot. Webhooks are account-based (per user). Supports both Clerk authentication (Bearer token) and API Key authentication (x-user-id, x-project-id, x-environment headers)
      operationId: WebhooksController_registerWebhook
      tags:
        - Webhooks
      security:
        - apiKey: []
      parameters:
        - name: environment
          required: false
          in: query
          description: Environment (sandbox or production) - required when using Clerk authentication, optional when using API Key authentication (uses x-environment header)
          schema:
            type: string
            enum:
              - sandbox
              - production
      requestBody:
        required: true
        description: Webhook registration details
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RegisterWebhookDto'
      responses:
        '200':
          description: Webhook registered successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RegisterWebhookResponseDto'
        '400':
          description: Invalid request data
        '401':
          description: Invalid or missing authentication
  /webhooks/unregister:
    delete:
      summary: Unregister a webhook URL
      description: Remove a webhook URL from receiving event notifications. Webhooks are account-based (per user). Supports both Clerk authentication (Bearer token) and API Key authentication (x-user-id, x-project-id, x-environment headers)
      operationId: WebhooksController_unregisterWebhook
      tags:
        - Webhooks
      security:
        - apiKey: []
      parameters:
        - name: environment
          required: false
          in: query
          description: Environment (sandbox or production) - required when using Clerk authentication, optional when using API Key authentication (uses x-environment header)
          schema:
            type: string
            enum:
              - sandbox
              - production
      requestBody:
        required: true
        description: Webhook unregistration details
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UnregisterWebhookDto'
      responses:
        '200':
          description: Webhook unregistered successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnregisterWebhookResponseDto'
        '400':
          description: Invalid request data
        '401':
          description: Invalid or missing authentication
  /webhooks/list:
    get:
      summary: List registered webhooks
      description: Get all registered webhook URLs for your account. Webhooks are account-based (per user). Supports both Clerk authentication (Bearer token) and API Key authentication (x-user-id, x-project-id, x-environment headers)
      operationId: WebhooksController_listWebhooks
      tags:
        - Webhooks
      security:
        - apiKey: []
      parameters:
        - name: environment
          required: false
          in: query
          description: Environment (sandbox or production) - required when using Clerk authentication, optional when using API Key authentication (uses x-environment header)
          schema:
            type: string
            enum:
              - sandbox
              - production
      responses:
        '200':
          description: List of registered webhooks
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ListWebhooksResponseDto'
        '400':
          description: Invalid query parameters
        '401':
          description: Invalid or missing authentication
components:
  securitySchemes:
    apiKey:
      type: apiKey
      in: header
      name: X-API-KEY
      description: API Key for authentication
  schemas:
    ConnectionRequestDto:
      type: object
      required:
        - leadUrl
        - linkedinAccountId
      properties:
        leadUrl:
          type: string
          description: LinkedIn profile URL of the lead
          example: https://www.linkedin.com/in/john-doe
        linkedinAccountId:
          type: string
          description: LinkedIn account database ID (use the accountId returned from the connect LinkedIn endpoint)
          example: clxxx123456
        connectionNote:
          type: string
          description: Optional connection note to include with the request (max 300 characters)
          example: Hi John, I noticed we share similar interests in tech...
          maxLength: 300
    ConnectionRequestResponseDto:
      type: object
      required:
        - action
      properties:
        action:
          type: string
          description: Action performed
          example: connection_request_sent
    FileUploadDto:
      type: object
      required:
        - fileId
        - filename
      properties:
        fileId:
          type: string
          description: Unique file identifier
          example: file_abc123
        filename:
          type: string
          description: Original filename
          example: document.pdf
    SendMessageDto:
      type: object
      required:
        - linkedinAccountId
      properties:
        linkedinAccountId:
          type: string
          description: LinkedIn account ID (use the linkedinAccountId returned from the connect LinkedIn endpoint)
          example: clxxx123456
        text:
          type: string
          description: Message text content
          example: Hi! I wanted to reach out about...
        attachments:
          type: array
          description: File attachments to include with the message
          items:
            $ref: '#/components/schemas/FileUploadDto'
        voiceMessage:
          description: Voice message attachment
          allOf:
            - $ref: '#/components/schemas/FileUploadDto'
        videoMessage:
          description: Video message attachment
          allOf:
            - $ref: '#/components/schemas/FileUploadDto'
        leadUrl:
          type: string
          description: LinkedIn profile URL of the lead to send message to
          example: https://www.linkedin.com/in/john-doe
    SendMessageResponseDto:
      type: object
      required:
        - action
      properties:
        action:
          type: string
          description: Action performed
          example: message_sent
    ParticipantProfileDto:
      type: object
      required:
        - profileUrl
        - name
      properties:
        profileUrl:
          type: string
          description: LinkedIn profile URL
          example: https://www.linkedin.com/in/john-doe
        name:
          type: string
          description: Full name of the participant
          example: John Doe
        profilePictureUrl:
          type: string
          description: Profile picture URL
          example: https://media.licdn.com/dms/image/...
        headline:
          type: string
          description: Professional headline
          example: Software Engineer at TechCorp
        location:
          type: string
          description: Location
          example: San Francisco, CA
    ConversationMessageDto:
      type: object
      required:
        - messageId
        - senderProfileUrl
        - text
        - sentAt
      properties:
        messageId:
          type: string
          description: Unique message identifier
          example: msg_abc123
        senderProfileUrl:
          type: string
          description: LinkedIn profile URL of the sender
          example: https://www.linkedin.com/in/john-doe
        text:
          type: string
          description: Message text content
          example: Hello, thanks for connecting!
        sentAt:
          type: string
          description: Timestamp when message was sent
          example: 2025-11-05T10:30:00Z
    ConversationDto:
      type: object
      required:
        - conversationId
        - participants
        - messages
        - lastMessageAt
        - unreadCount
      properties:
        conversationId:
          type: string
          description: Unique conversation identifier
          example: conv_abc123def456
        participants:
          type: array
          description: Array of participants in the conversation (excluding the provided LinkedIn account)
          items:
            $ref: '#/components/schemas/ParticipantProfileDto'
        messages:
          type: array
          description: Array of messages in the conversation
          items:
            $ref: '#/components/schemas/ConversationMessageDto'
        lastMessageAt:
          type: string
          description: Timestamp of the last message in the conversation
          example: 2025-11-05T10:30:00Z
        unreadCount:
          type: number
          description: Number of unread messages in the conversation
          example: 0
    GetMessagesResponseDto:
      type: object
      required:
        - conversations
        - page
      properties:
        conversations:
          type: array
          description: Array of conversations
          items:
            $ref: '#/components/schemas/ConversationDto'
        page:
          type: number
          description: Current page number
          example: 0
    AccountStatusDto:
      type: object
      required:
        - linkedinAccountId
        - status
        - remainingConnectionRequests
        - remainingMessages
        - dailyConnectionCap
        - dailyMessageCap
      properties:
        linkedinAccountId:
          type: string
          description: LinkedIn Account identifier
          example: acc_123456
        status:
          type: string
          description: Account status (active, inactive, suspended)
          example: active
        remainingConnectionRequests:
          type: number
          description: Remaining connection requests for today
          example: 45
        remainingMessages:
          type: number
          description: Remaining messages for today
          example: 150
        dailyConnectionCap:
          type: number
          description: Daily connection request limit
          example: 50
        dailyMessageCap:
          type: number
          description: Daily message limit
          example: 200
    GetAccountStatusResponseDto:
      type: object
      required:
        - accounts
      properties:
        accounts:
          type: array
          description: Array of account statuses
          items:
            $ref: '#/components/schemas/AccountStatusDto'
    AccountLogoutDto:
      type: object
      required:
        - linkedinAccountId
      properties:
        linkedinAccountId:
          type: string
          description: LinkedIn Account ID to logout
          example: acc_123456
    AccountLogoutResponseDto:
      type: object
      required:
        - action
      properties:
        action:
          type: string
          description: Action performed
          example: account_logged_out
    ProxyDto:
      type: object
      required:
        - protocol
        - host
        - port
      properties:
        protocol:
          type: string
          description: Proxy protocol
          enum:
            - https
            - http
            - socks5
          example: http
        host:
          type: string
          description: Proxy host address
          example: proxy.example.com
        port:
          type: number
          description: Proxy port number
          example: 8080
        username:
          type: string
          description: Optional username for proxy authentication
          example: proxyuser
        password:
          type: string
          description: Optional password for proxy authentication
          example: proxypass
    ConnectLinkedInDto:
      type: object
      required:
        - username
        - password
        - userAgent
      properties:
        username:
          type: string
          description: LinkedIn username - should be either an email address or a phone number
          example: user@example.com
        password:
          type: string
          description: LinkedIn account password
          example: securepassword123
        userAgent:
          type: string
          description: User agent string - if encountering disconnection issues, enter the exact user agent of the browser on which the account has been connected
          example: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36
        accessToken:
          type: string
          description: LinkedIn access token for authentication
          example: AQV8...
        premiumToken:
          type: string
          description: LinkedIn premium token (if applicable)
          example: premium_token_123
        country:
          type: string
          description: ISO 3166-1 A-2 country code (2 characters) to be set as proxy location
          example: US
        ip:
          type: string
          description: IPv4 address to infer proxy location
          example: 192.168.1.1
        proxy:
          description: Proxy configuration
          allOf:
            - $ref: '#/components/schemas/ProxyDto'
    ConnectLinkedInResponseDto:
      type: object
      required:
        - action
        - data
      properties:
        action:
          type: string
          description: Action performed
          example: account_connected
        data:
          type: object
          description: Account data - linkedinAccountId is the LinkedIn account database ID to use for messaging
          example:
            linkedinAccountId: clxxx123456
    ReconnectLinkedInDto:
      type: object
      required:
        - linkedinAccountId
        - username
        - password
        - userAgent
      properties:
        linkedinAccountId:
          type: string
          description: LinkedIn Account ID to reconnect
          example: clxxx123456
        username:
          type: string
          description: LinkedIn username - should be either an email address or a phone number
          example: user@example.com
        password:
          type: string
          description: LinkedIn account password
          example: securepassword123
        userAgent:
          type: string
          description: User agent string - if encountering disconnection issues, enter the exact user agent of the browser on which the account has been connected
          example: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36
        accessToken:
          type: string
          description: LinkedIn access token for authentication
          example: AQV8...
        premiumToken:
          type: string
          description: LinkedIn premium token (if applicable)
          example: premium_token_123
        country:
          type: string
          description: ISO 3166-1 A-2 country code (2 characters) to be set as proxy location
          example: US
        ip:
          type: string
          description: IPv4 address to infer proxy location
          example: 192.168.1.1
        proxy:
          description: Proxy configuration
          allOf:
            - $ref: '#/components/schemas/ProxyDto'
    ReconnectLinkedInResponseDto:
      type: object
      required:
        - action
        - data
      properties:
        action:
          type: string
          description: Action performed
          example: account_reconnected
        data:
          type: object
          description: Account data - linkedinAccountId is the LinkedIn account database ID
          example:
            linkedinAccountId: clxxx123456
    RegisterWebhookDto:
      type: object
      required:
        - url
        - events
      properties:
        url:
          type: string
          description: Webhook URL to receive events
          example: https://your-app.com/webhooks/sendpilot
        secret:
          type: string
          description: Webhook secret for signature verification
          example: your_webhook_secret_123
        events:
          type: array
          description: 'List of event types to subscribe to. Accepts both formats: UPPERCASE_UNDERSCORE (MESSAGE_RECEIVED) or lowercase.dot (message.received). Use * for all events.'
          items:
            type: string
          example:
            - MESSAGE_RECEIVED
            - CONNECTION_ACCEPTED
            - ACCOUNT_DISCONNECTED
    RegisterWebhookResponseDto:
      type: object
      required:
        - status
        - url
      properties:
        status:
          type: string
          description: Status of webhook registration
          example: registered
        url:
          type: string
          description: Registered webhook URL
          example: https://your-app.com/webhooks/sendpilot
    UnregisterWebhookDto:
      type: object
      required:
        - url
      properties:
        url:
          type: string
          description: Webhook URL to unregister
          example: https://your-app.com/webhooks/sendpilot
    UnregisterWebhookResponseDto:
      type: object
      required:
        - status
      properties:
        status:
          type: string
          description: Status of webhook unregistration
          example: unregistered
    ListWebhooksResponseDto:
      type: object
      required:
        - webhooks
      properties:
        webhooks:
          type: array
          description: List of registered webhooks
          items:
            type: object
